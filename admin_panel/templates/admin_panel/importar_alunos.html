{% extends "admin/base_site.html" %}
{% load static %}

{% block extrastyle %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static 'admin_panel/css/importar_page.css' %}">
{% endblock %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div id="content-main">

    <a href="{% url 'admin:index' %}" class="back-button">
        &larr; Voltar ao Painel Principal
    </a>

    <h1>Importar Alunos para Turma</h1>

    {% if messages %}
        <ul class="messages">
            {% for message in messages %}
            <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    <div class="import-layout">

        <div class="form-panel">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <label for="turma_id">Selecione a Turma:</label>
                <select name="turma_id" id="turma_id" required>
                    <option value="">--- Selecione ---</option>
                    {% for turma in turmas %}
                    <option value="{{ turma.pk }}">
                        {{ turma.nome }} ({{ turma.identificador_turma }})
                    </option>
                    {% endfor %}
                </select>
                <br><br>

                <label for="arquivo_alunos">Arquivo CSV/Excel:</label>
                <input type="file" name="arquivo_alunos" id="arquivo_alunos" accept=".csv, .xlsx, .xls" required>
                <br><br>

                <button type="submit" class="default">Importar Alunos</button>
            </form>
        </div>

        <div class="tip-panel">
            <h3>Como Formatar seu Arquivo</h3>
            <p>
                Por favor, envie um arquivo <strong>CSV</strong> ou <strong>Excel (.xlsx, .xls)</strong>.
            </p>
            <p>
                O arquivo <strong>deve</strong> conter a coluna <code>nome_completo</code>.
                A coluna <code>matricula</code> Ã© opcional.
            </V>

            <strong>Exemplo:</strong>
            <img src="{% static 'admin_panel/images/exemplo-importacao.png' %}" alt="Exemplo de planilha Excel com colunas nome_completo e matricula">
        </div>

    </div> </div>
{% endblock %}